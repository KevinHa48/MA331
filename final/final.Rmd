---
title: "MA-331 Final"
author: "Kevin Ha"
date: "12/14/2021"
output: html_document
---

---

```{r, echo = FALSE}
library(readxl)
biomark <- read_excel("Biomark.xls")
```

### Problem 11.36

##### **Problem 11.36a**

```{r, figures-sode, fig.show = "hold", out.width = "35%", echo = FALSE}
plot(density(biomark$voplus), main = "VO+")
plot(density(biomark$vominus), main = "VO-")
plot(density(biomark$oc), main = "OC")
plot(density(biomark$trap), main = "TRAP")
```

```{r, echo = FALSE}
sd_vo_p = sd(biomark$voplus)
sd_vo_m = sd(biomark$vominus)
sd_oc = sd(biomark$oc)
sd_trap = sd(biomark$trap)
```


Numerical summary for VO+:

```{r, echo = FALSE}
summary(biomark$voplus)
```

$s_{VO+}=`r sd_vo_p`$


Numerical summary for VO-:

```{r, echo = FALSE}
summary(biomark$vominus)
```

$s_{VO-}=`r sd_vo_m`$

Numerical summary for OC:

```{r, echo = FALSE}
summary(biomark$oc)
```

$s_{OC}=`r sd_oc`$


Numerical summary for TRAP:

```{r, echo = FALSE}
summary(biomark$trap)
```

$s_{TRAP}=`r sd_trap`$

Graphical summary for all and the distribution: **Right skewed.**

##### **Problem 11.36b**

**Numerical summary:**

```{r, echo = FALSE}
smallcs = subset(biomark, select = c("voplus", "vominus", "oc", "trap"))
with(biomark, cor(smallcs))
```

**Graphical Summary:**

```{r, echo = FALSE}
pairs(smallcs, pch = ".")
```

**All pairs exhibit a linear and positive association with varying strength as determined by their correlation numbers.**

### Problem 11.37
##### Problem 11.37a
```{r, echo = FALSE, out.width = "40%"}
fm1 = lm(voplus ~ oc, data = biomark)
summary(fm1)

qqnorm(residuals.lm(fm1))
abline(0,400)
```

$VO+ = 334 + 19.51OC$

**The plot of residuals against OC is sightly curved.**

\

##### Problem 11.37b

```{r, echo = FALSE}
fm2 = lm(voplus ~ oc + trap, data = biomark)
summary(fm2)
```

$VO+ = 58 + 6.41OC + 53.9TRAP$

**The view that TRAP is a better predictor of bone formation than OC is consistent with the results from 11.36 as the p-value for TRAP is significantly lower than the p-value for OC.**

\

### Problem 11.38

##### Problem 11.38a

$y_{i} = \beta_0 + \beta_1x_{i1} + \beta_2x_{i2} + \beta_3x_{i1} + \epsilon_i$ 

**Assumption:** $\epsilon_i$ is assumed to be independent and $N(0, \sigma$)

##### Problem 11.38b

```{r, echo = FALSE}
fm3 = lm(voplus ~ oc + trap + vominus, data = biomark)
summary(fm3)
```

\

##### Problem 11.38c

![](table.png)
EC = Estimated Coefficient

SE = Standard Error

**The coefficients and P-values differ significantly between all three tables.**

\

##### Problem 11.38d

**11.37a:** Percent of variation is 43.51% (obtained from Multiple R-squared section in the summary) and the estimate of $\sigma = 443.3$

**11.37b:** Percent of variation is 60.7% (obtained from Multiple R-squared section in the summary) and the estimate of $\sigma = 376.3$

**11.38b:** Percent of variation is 88.44% (obtained from Multiple R-squared section in the summary) and the estimate of $\sigma = 207.8$

\

##### Problem 11.38e

*11.38b suggests that TRAP coefficient is not significant, so remove it.*

```{r, echo = FALSE}
fm4 = lm(voplus ~ oc + vominus, data = biomark)
summary(fm4)
```

**Better performance in terms of P-value compared to part B.**

### Problem 11.39

```{r, echo = FALSE}
smallcs2 = subset(biomark, select = c("lvoplus", "lvominus", "loc", "ltrap"))
head(with(biomark, cor(smallcs2)), 1)
```

```{r, echo = FALSE, results = "asis", message = FALSE}
fm5 = lm(lvoplus ~ loc, data = biomark)
fm6 = lm(lvoplus ~ loc + ltrap, data = biomark)
fm7 = lm(lvoplus ~ loc + ltrap + lvominus, data = biomark)
fm8 = lm(lvoplus ~ loc + lvominus, data = biomark)
library(stargazer)
stargazer(fm5, fm6, fm7, fm8, align = TRUE, type = "html", report = ("vcpt*"), header = FALSE)

```

\

$LVO+ = 4.38 + 0.706LOC$

$LVO+ = 4.26 + 0.430LOC + 0.424LTRAP$

$LVO+ = 0.872 + 0.392LOC + 0.028LTRAP + 0.673LVO-$

Model without LTRAP since it is insignificant (#4 in the table above):

$LVO+ = 0.832 + 0.406LOC  + 0.682LVO-$

### Problem 11.40

**11.36:**
```{r, echo = FALSE}
smallcs3 = subset(biomark, select = c("vominus", "voplus", "oc", "trap"))
head(with(biomark, cor(smallcs3)), 1)
```

(Graphs remain the same and other numerical summaries remain the same)

**11.37: (#1 is Part A, #2 is Part B)**
```{r, echo = FALSE, out.width = "40%", results = "asis"}
fm9 = lm(vominus ~ oc, data = biomark)
fm10 = lm(vominus ~ oc + trap, data = biomark)
stargazer(fm9, fm10, align = TRUE, type = "html", report = ("vcpt*"), header = FALSE)

qqnorm(residuals.lm(fm1))
abline(5,300)
```
**The plot of residuals against OC is sightly curved again.**

$VO- = 557.82 + 9.92OC$ (Part A)

$VO- = 309.05 - 1.87OC + 48.5TRAP$ (Part B)

**The view that TRAP is a better predictor of bone formation than OC is still consistent with the results from 11.36 as the p-value for TRAP is significantly lower than the p-value for OC.**

**11.38 (#1 is Part B, #2 is Part E)**
```{r, echo = FALSE, results = "asis"}
fm11 = lm(vominus ~ oc + trap + voplus, data = biomark)
fm12 = lm(vominus ~ oc + voplus, data = biomark)

stargazer(fm11, fm12, align = TRUE, type = "html", report = ("vcpt*"))
```

\

$VO- = 267.26 - 6.51OC + 9.48TRAP + 0.72VO+$ (Part B)

$VO- = 298.01 - 5.254OC + 0.78VO+$ (Part E)

### Problem 11.41

**11.36:**
```{r, echo = FALSE}
smallcs4 = subset(biomark, select = c("lvominus", "lvoplus", "loc", "ltrap"))
head(with(biomark, cor(smallcs4)), 1)
```

(Graphs remain the same and other numerical summaries remain the same)

**11.37: (#1 is Part A, #2 is Part B)**
```{r, echo = FALSE, out.width = "40%", results = "asis"}
fm13 = lm(lvominus ~ loc, data = biomark)
fm14 = lm(lvominus ~ loc + ltrap, data = biomark)
stargazer(fm13, fm14, align = TRUE, type = "html", report = ("vcpt*"), header = FALSE)

qqnorm(residuals.lm(fm1))
abline(5,300)
```
**The plot of residuals against OC is sightly curved again.**

$VO- = 5.21 + 0.44OC$ (Part A)

$VO- = 5.04 - 0.06OC + 0.59TRAP$ (Part B)

**The view that TRAP is a better predictor of bone formation than OC is still consistent with the results from 11.36 as the p-value for TRAP is significantly lower than the p-value for OC.**

**11.38 (#1 is Part B, #2 is Part E)**
```{r, echo = FALSE, results = "asis"}
fm15 = lm(lvominus ~ loc + ltrap + lvoplus, data = biomark)
fm16 = lm(lvominus ~ loc + lvoplus, data = biomark)

stargazer(fm15, fm16, align = TRUE, type = "html", report = ("vcpt*"))
```

\

$LVO- = 1.57 - 0.29LOC + 0.25LTRAP + 0.81LVO+$ (Part B)

$LVO- = 1.31 - 0.19LOC + 0.89LVO+$ (Part E)
